---
pagination:
  data: collections.postsByYear
  size: 1
  alias: year
layout: posts-base
permalink: /{{ year[0] }}/
---

{% set yearPosts = year[1] %}
{% set noteCount = yearPosts | selectattr("inputPath", "containing", "/notes/") | list | length %}
{% set bookmarkCount = yearPosts | selectattr("inputPath", "containing", "/bookmarks/") | list | length %}
{% set otherCount = yearPosts | length - noteCount - bookmarkCount %}
{% set totalCount = yearPosts | length %}

<div style="margin-bottom: 3vw;">
  <nav aria-label="Archive navigation" style="margin-bottom: 1vw;">
    <div class="meta-pill">
      <a href="/" class="meta-segment">Home</a>
    </div>
  </nav>

  <p class="post-count" style="display: inline-flex; gap: 0.5em; flex-wrap: wrap;">
    <a href="/{{ year[0] }}/" class="pill">{{ year[0] }}</a>
    {% if otherCount > 0 %}<span class="pill">{{ otherCount }} post{{ "s" if otherCount != 1 }}</span>{% endif %}
    {% if noteCount > 0 %}<a href="/notes/" class="pill">{{ noteCount }} note{{ "s" if noteCount != 1 }}</a>{% endif %}
    {% if bookmarkCount > 0 %}<a href="/bookmarks/" class="pill">{{ bookmarkCount }} bookmark{{ "s" if bookmarkCount != 1 }}</a>{% endif %}
  </p>
</div>

<div class="posts-list h-feed">
  {% set renderedDates = [] %}
  {% for post in yearPosts | reverse %}
    {% set dateKey = post.data.date | date('iso') %}
    {% if dateKey not in renderedDates %}
      {% set renderedDates = renderedDates + [dateKey] %}
      {% set dateParts = dateKey.split('-') %}
      <h2 class="date-header">
        <div class="meta-pill">
          <a href="/{{ dateParts[0] }}/" class="meta-segment">{{ dateParts[0] }}</a>
          <a href="/{{ dateParts[0] }}/{{ dateParts[1] }}/" class="meta-segment">{{ dateParts[1] }}</a>
          <a href="/{{ dateParts[0] }}/{{ dateParts[1] }}/{{ dateParts[2] }}/" class="meta-segment">{{ dateParts[2] }}</a>
        </div>
      </h2>
    {% endif %}
    {% include "post-display.njk" %}
  {% endfor %}
</div>